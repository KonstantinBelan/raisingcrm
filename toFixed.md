# Raising CRM - –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

> –î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞: –Ø–Ω–≤–∞—Ä—å 2025  
> –í–µ—Ä—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞: 0.1.0  
> –°—Ç–∞—Ç—É—Å: 85% –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É

---

## üìä –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

### –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã ‚úÖ
- **–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å—Ç–µ–∫**: Next.js 15, React 19, TypeScript, Prisma
- **–•–æ—Ä–æ—à–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: –ß–µ—Ç–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫, —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏
- **Mobile-first –ø–æ–¥—Ö–æ–¥**: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è Telegram Mini App
- **–ë–æ–≥–∞—Ç—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª**: –ü—Ä–æ–µ–∫—Ç—ã, –∑–∞–¥–∞—á–∏, –∫–ª–∏–µ–Ω—Ç—ã, –ø–ª–∞—Ç–µ–∂–∏, –∫–∞–ª–µ–Ω–¥–∞—Ä—å
- **PWA –ø–æ–¥–¥–µ—Ä–∂–∫–∞**: –û—Ñ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **UI/UX**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ shadcn/ui, –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã üî¥
1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: Mock –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –≤ production –∫–æ–¥–µ
2. **TypeScript –æ—à–∏–±–∫–∏**: –ù–µ—Å–∫–æ–ª—å–∫–æ type errors
3. **ESLint –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è**: `any` —Ç–∏–ø—ã, –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
4. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–µ—Å—Ç–æ–≤**: –ù–µ—Ç unit/integration —Ç–µ—Å—Ç–æ–≤
5. **–ù–µ–ø–æ–ª–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è**: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç zod –∏–ª–∏ –ø–æ–¥–æ–±–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
6. **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç CI/CD**: –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

---

## üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø (–°–†–û–ß–ù–û)

### 1. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

#### –ü—Ä–æ–±–ª–µ–º–∞
```typescript
// src/lib/auth.ts
export async function auth(request: NextRequest): Promise<AuthSession | null> {
  try {
    // ‚ùå –ö–†–ò–¢–ò–ß–ù–û: Mock –¥–∞–Ω–Ω—ã–µ –≤ production!
    return {
      userId: 'cmfmq07ub0000nlarbsy9j798',
      telegramId: '123456789',
      username: 'testuser',
      firstName: '–¢–µ—Å—Ç',
    };
  }
}
```

#### –†–µ—à–µ–Ω–∏–µ
```typescript
import { NextRequest } from 'next/server';
import { parseUserFromInitData, validateTelegramWebAppData } from './telegram';
import { prisma } from './prisma';

export interface AuthSession {
  userId: string;
  telegramId: string;
  username?: string;
  firstName?: string;
}

export async function auth(request: NextRequest): Promise<AuthSession | null> {
  try {
    // –ü–æ–ª—É—á–∞–µ–º initData –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∏–ª–∏ –∫—É–∫–æ–≤
    const initData = request.headers.get('x-telegram-init-data') || 
                     request.cookies.get('telegram-init-data')?.value;
    
    if (!initData) {
      console.error('No Telegram init data provided');
      return null;
    }

    // –í–∞–ª–∏–¥–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ Telegram
    const botToken = process.env.TELEGRAM_BOT_TOKEN;
    if (!botToken) {
      throw new Error('TELEGRAM_BOT_TOKEN not configured');
    }

    const isValid = await validateTelegramWebAppData(initData, botToken);
    if (!isValid) {
      console.error('Invalid Telegram init data');
      return null;
    }

    // –ü–∞—Ä—Å–∏–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    const userData = parseUserFromInitData(initData);
    if (!userData) {
      console.error('Failed to parse user data');
      return null;
    }

    // –ù–∞—Ö–æ–¥–∏–º –∏–ª–∏ —Å–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î
    let user = await prisma.user.findUnique({
      where: { telegramId: userData.telegramId },
    });

    if (!user) {
      user = await prisma.user.create({
        data: {
          telegramId: userData.telegramId,
          username: userData.username,
          firstName: userData.firstName,
          lastName: userData.lastName,
        },
      });
    }

    return {
      userId: user.id,
      telegramId: user.telegramId,
      username: user.username || undefined,
      firstName: user.firstName || undefined,
    };
  } catch (error) {
    console.error('Auth error:', error);
    return null;
  }
}

// Middleware –¥–ª—è –∑–∞—â–∏—Ç—ã API routes
export async function requireAuth(request: NextRequest): Promise<AuthSession> {
  const session = await auth(request);
  if (!session) {
    throw new Error('Unauthorized');
  }
  return session;
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üî¥ **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô**  
**–í—Ä–µ–º—è**: 2-3 —á–∞—Å–∞

---

### 2. TypeScript –æ—à–∏–±–∫–∏

#### –ü—Ä–æ–±–ª–µ–º–∞ –≤ ExportManager.tsx
```typescript
// src/components/export/ExportManager.tsx:346
<Checkbox
  checked={includeTimeSessions}
  onCheckedChange={setIncludeTimeSessions} // ‚ùå Type error
/>
```

#### –†–µ—à–µ–Ω–∏–µ
```typescript
import { CheckedState } from '@radix-ui/react-checkbox';

<Checkbox
  checked={includeTimeSessions}
  onCheckedChange={(checked: CheckedState) => {
    setIncludeTimeSessions(checked === true);
  }}
/>
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üî¥ **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô**  
**–í—Ä–µ–º—è**: 30 –º–∏–Ω—É—Ç

---

### 3. ESLint –æ—à–∏–±–∫–∏ - explicit any

#### –ü—Ä–æ–±–ª–µ–º–∞
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `any` –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–∞–π–ª–∞—Ö –±–µ–∑ —Ç–∏–ø–∏–∑–∞—Ü–∏–∏.

#### –†–µ—à–µ–Ω–∏–µ
–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª —Å —Ç–∏–ø–∞–º–∏:

```typescript
// src/types/api.ts
export interface Project {
  id: string;
  title: string;
  description?: string;
  status: 'ACTIVE' | 'PAUSED' | 'COMPLETED' | 'CANCELLED';
  budget?: number;
  currency: string;
  startDate?: Date;
  deadline?: Date;
  endDate?: Date;
  priority: 'LOW' | 'MEDIUM' | 'HIGH' | 'URGENT';
  createdAt: Date;
  updatedAt: Date;
  userId: string;
  clientId?: string;
  client?: {
    id: string;
    name: string;
  };
  tasks?: Task[];
  payments?: Payment[];
  _count?: {
    tasks: number;
    payments: number;
  };
}

export interface Task {
  id: string;
  title: string;
  description?: string;
  status: 'TODO' | 'IN_PROGRESS' | 'REVIEW' | 'DONE';
  priority: 'LOW' | 'MEDIUM' | 'HIGH' | 'URGENT';
  estimatedHours?: number;
  actualHours?: number;
  deadline?: Date;
  dueDate?: Date;
  createdAt: Date;
  updatedAt: Date;
  userId: string;
  projectId?: string;
  parentTaskId?: string;
  project?: Project;
}

export interface Client {
  id: string;
  name: string;
  email?: string;
  phone?: string;
  company?: string;
  notes?: string;
  createdAt: Date;
  updatedAt: Date;
  userId: string;
  projects?: Project[];
}

export interface Payment {
  id: string;
  amount: number;
  currency: string;
  status: 'PENDING' | 'PAID' | 'OVERDUE' | 'CANCELLED';
  description?: string;
  dueDate?: Date;
  paidDate?: Date;
  createdAt: Date;
  updatedAt: Date;
  userId: string;
  projectId?: string;
  project?: Project;
}

export interface ApiResponse<T> {
  success: boolean;
  data?: T;
  error?: string;
}
```

–ó–∞—Ç–µ–º –∑–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ `any` –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–∏–ø—ã:

```typescript
// ‚ùå –ë—ã–ª–æ
const projects = projectsData.projects || [];
const newProjectsThisWeek = projects.filter((p: any) => 
  new Date(p.createdAt) > weekAgo
).length;

// ‚úÖ –°—Ç–∞–ª–æ
import { Project } from '@/types/api';

const projects: Project[] = projectsData.projects || [];
const newProjectsThisWeek = projects.filter((p: Project) => 
  new Date(p.createdAt) > weekAgo
).length;
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üî¥ **–í–´–°–û–ö–ò–ô**  
**–í—Ä–µ–º—è**: 2-3 —á–∞—Å–∞

---

## üü° –í–ê–ñ–ù–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø

### 4. –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Å Zod

#### –ü—Ä–æ–±–ª–µ–º–∞
–ù–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö –≤ API routes.

#### –†–µ—à–µ–Ω–∏–µ
```bash
npm install zod
```

```typescript
// src/lib/validations/project.ts
import { z } from 'zod';

export const createProjectSchema = z.object({
  title: z.string().min(1, '–ù–∞–∑–≤–∞–Ω–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ').max(200),
  description: z.string().max(2000).optional(),
  budget: z.number().positive().optional(),
  currency: z.string().length(3).default('RUB'),
  startDate: z.string().datetime().optional(),
  endDate: z.string().datetime().optional(),
  deadline: z.string().datetime().optional(),
  priority: z.enum(['LOW', 'MEDIUM', 'HIGH', 'URGENT']).default('MEDIUM'),
  clientId: z.string().cuid().optional(),
});

export const updateProjectSchema = createProjectSchema.partial();

export type CreateProjectInput = z.infer<typeof createProjectSchema>;
export type UpdateProjectInput = z.infer<typeof updateProjectSchema>;
```

```typescript
// src/app/api/projects/route.ts
import { createProjectSchema } from '@/lib/validations/project';
import { ZodError } from 'zod';

export async function POST(request: NextRequest) {
  try {
    const session = await requireAuth(request);
    const body = await request.json();

    // –í–∞–ª–∏–¥–∞—Ü–∏—è —Å Zod
    const validatedData = createProjectSchema.parse(body);

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞
    if (validatedData.clientId) {
      const client = await prisma.client.findFirst({
        where: {
          id: validatedData.clientId,
          userId: session.userId,
        },
      });

      if (!client) {
        return NextResponse.json(
          { success: false, error: 'Client not found' },
          { status: 404 }
        );
      }
    }

    const project = await prisma.project.create({
      data: {
        ...validatedData,
        userId: session.userId,
        budget: validatedData.budget ? validatedData.budget : null,
        startDate: validatedData.startDate ? new Date(validatedData.startDate) : null,
        endDate: validatedData.endDate ? new Date(validatedData.endDate) : null,
        deadline: validatedData.deadline ? new Date(validatedData.deadline) : null,
      },
      include: {
        client: true,
        tasks: true,
      },
    });

    return NextResponse.json({ success: true, project });
  } catch (error) {
    if (error instanceof ZodError) {
      return NextResponse.json(
        { 
          success: false, 
          error: 'Validation error',
          details: error.errors 
        },
        { status: 400 }
      );
    }

    console.error('Error creating project:', error);
    return NextResponse.json(
      { success: false, error: 'Internal server error' },
      { status: 500 }
    );
  }
}
```

–°–æ–∑–¥–∞—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π:
- `src/lib/validations/project.ts`
- `src/lib/validations/task.ts`
- `src/lib/validations/client.ts`
- `src/lib/validations/payment.ts`
- `src/lib/validations/reminder.ts`

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü° **–í–´–°–û–ö–ò–ô**  
**–í—Ä–µ–º—è**: 4-5 —á–∞—Å–æ–≤

---

### 5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –ü—Ä–æ–±–ª–µ–º–∞
–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è.

#### –†–µ—à–µ–Ω–∏–µ
```bash
npm install pino pino-pretty
```

```typescript
// src/lib/logger.ts
import pino from 'pino';

export const logger = pino({
  level: process.env.LOG_LEVEL || 'info',
  transport: process.env.NODE_ENV === 'development' 
    ? {
        target: 'pino-pretty',
        options: {
          colorize: true,
          translateTime: 'HH:MM:ss Z',
          ignore: 'pid,hostname',
        },
      }
    : undefined,
});

// Helper –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫ API
export function logApiError(error: unknown, context: string) {
  if (error instanceof Error) {
    logger.error({
      context,
      message: error.message,
      stack: error.stack,
    });
  } else {
    logger.error({ context, error });
  }
}
```

```typescript
// src/lib/errors.ts
export class AppError extends Error {
  constructor(
    public message: string,
    public statusCode: number = 500,
    public code?: string
  ) {
    super(message);
    this.name = 'AppError';
  }
}

export class ValidationError extends AppError {
  constructor(message: string, public details?: unknown) {
    super(message, 400, 'VALIDATION_ERROR');
    this.name = 'ValidationError';
  }
}

export class AuthenticationError extends AppError {
  constructor(message: string = 'Unauthorized') {
    super(message, 401, 'AUTHENTICATION_ERROR');
    this.name = 'AuthenticationError';
  }
}

export class NotFoundError extends AppError {
  constructor(resource: string) {
    super(`${resource} not found`, 404, 'NOT_FOUND');
    this.name = 'NotFoundError';
  }
}

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ –¥–ª—è API routes
export function handleApiError(error: unknown): Response {
  if (error instanceof AppError) {
    return NextResponse.json(
      {
        success: false,
        error: error.message,
        code: error.code,
        ...(error instanceof ValidationError && { details: error.details }),
      },
      { status: error.statusCode }
    );
  }

  if (error instanceof ZodError) {
    return NextResponse.json(
      {
        success: false,
        error: 'Validation error',
        code: 'VALIDATION_ERROR',
        details: error.errors,
      },
      { status: 400 }
    );
  }

  // –õ–æ–≥–∏—Ä—É–µ–º –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏
  logApiError(error, 'Unhandled API error');

  return NextResponse.json(
    {
      success: false,
      error: 'Internal server error',
      code: 'INTERNAL_ERROR',
    },
    { status: 500 }
  );
}
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:

```typescript
// src/app/api/projects/route.ts
import { requireAuth } from '@/lib/auth';
import { handleApiError, NotFoundError } from '@/lib/errors';
import { logger } from '@/lib/logger';

export async function GET(request: NextRequest) {
  try {
    const session = await requireAuth(request);
    
    logger.info({ userId: session.userId }, 'Fetching projects');

    const projects = await prisma.project.findMany({
      where: { userId: session.userId },
      include: { client: true, tasks: true },
    });

    return NextResponse.json({ success: true, projects });
  } catch (error) {
    return handleApiError(error);
  }
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü° **–í–´–°–û–ö–ò–ô**  
**–í—Ä–µ–º—è**: 3-4 —á–∞—Å–∞

---

### 6. Environment –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

#### –ü—Ä–æ–±–ª–µ–º–∞
–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—è environment –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

#### –†–µ—à–µ–Ω–∏–µ
```typescript
// src/lib/env.ts
import { z } from 'zod';

const envSchema = z.object({
  // Database
  DATABASE_URL: z.string().url(),

  // Telegram
  TELEGRAM_BOT_TOKEN: z.string().min(1),
  TELEGRAM_WEBHOOK_SECRET: z.string().min(1),

  // OpenRouter AI
  OPENROUTER_API_KEY: z.string().min(1).optional(),

  // Auth
  NEXTAUTH_SECRET: z.string().min(32),
  NEXTAUTH_URL: z.string().url(),

  // App
  NODE_ENV: z.enum(['development', 'production', 'test']).default('development'),
  PORT: z.string().default('3000'),
  LOG_LEVEL: z.enum(['debug', 'info', 'warn', 'error']).default('info'),

  // Optional
  REDIS_URL: z.string().url().optional(),
  SENTRY_DSN: z.string().url().optional(),
});

export type Env = z.infer<typeof envSchema>;

function validateEnv(): Env {
  try {
    return envSchema.parse(process.env);
  } catch (error) {
    if (error instanceof z.ZodError) {
      console.error('‚ùå Invalid environment variables:');
      error.errors.forEach((err) => {
        console.error(`  ${err.path.join('.')}: ${err.message}`);
      });
      process.exit(1);
    }
    throw error;
  }
}

export const env = validateEnv();
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
```typescript
import { env } from '@/lib/env';

// –í–º–µ—Å—Ç–æ process.env.TELEGRAM_BOT_TOKEN
const botToken = env.TELEGRAM_BOT_TOKEN;
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü° **–°–†–ï–î–ù–ò–ô**  
**–í—Ä–µ–º—è**: 1-2 —á–∞—Å–∞

---

### 7. Rate Limiting –∏ –∑–∞—â–∏—Ç–∞ API

#### –ü—Ä–æ–±–ª–µ–º–∞
–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∑–∞—â–∏—Ç–∞ –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π API.

#### –†–µ—à–µ–Ω–∏–µ
```bash
npm install @upstash/ratelimit @upstash/redis
```

```typescript
// src/lib/rate-limit.ts
import { Ratelimit } from '@upstash/ratelimit';
import { Redis } from '@upstash/redis';
import { NextRequest, NextResponse } from 'next/server';

const redis = process.env.REDIS_URL 
  ? new Redis({ url: process.env.REDIS_URL })
  : undefined;

// –†–∞–∑–Ω—ã–µ –ª–∏–º–∏—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö endpoints
export const rateLimiters = {
  api: redis ? new Ratelimit({
    redis,
    limiter: Ratelimit.slidingWindow(60, '1 m'), // 60 requests per minute
    analytics: true,
  }) : null,

  auth: redis ? new Ratelimit({
    redis,
    limiter: Ratelimit.slidingWindow(10, '1 m'), // 10 attempts per minute
    analytics: true,
  }) : null,

  aiAnalysis: redis ? new Ratelimit({
    redis,
    limiter: Ratelimit.slidingWindow(20, '1 h'), // 20 requests per hour
    analytics: true,
  }) : null,
};

export async function checkRateLimit(
  request: NextRequest,
  limiter: Ratelimit | null,
  identifier?: string
): Promise<{ success: boolean; response?: NextResponse }> {
  if (!limiter) {
    // –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –±–µ–∑ Redis –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
    return { success: true };
  }

  const ip = request.headers.get('x-forwarded-for') || 
             request.headers.get('x-real-ip') || 
             'anonymous';
  
  const id = identifier || ip;

  const { success, limit, reset, remaining } = await limiter.limit(id);

  if (!success) {
    return {
      success: false,
      response: NextResponse.json(
        {
          success: false,
          error: 'Too many requests',
          code: 'RATE_LIMIT_EXCEEDED',
          limit,
          remaining,
          reset: new Date(reset).toISOString(),
        },
        { 
          status: 429,
          headers: {
            'X-RateLimit-Limit': limit.toString(),
            'X-RateLimit-Remaining': remaining.toString(),
            'X-RateLimit-Reset': new Date(reset).toISOString(),
          },
        }
      ),
    };
  }

  return { success: true };
}
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ API routes:

```typescript
// src/app/api/projects/route.ts
import { checkRateLimit, rateLimiters } from '@/lib/rate-limit';

export async function GET(request: NextRequest) {
  try {
    const session = await requireAuth(request);

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ rate limit
    const rateLimitCheck = await checkRateLimit(
      request,
      rateLimiters.api,
      session.userId
    );

    if (!rateLimitCheck.success) {
      return rateLimitCheck.response;
    }

    // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥
  } catch (error) {
    return handleApiError(error);
  }
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü° **–°–†–ï–î–ù–ò–ô**  
**–í—Ä–µ–º—è**: 2-3 —á–∞—Å–∞

---

### 8. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –ü—Ä–æ–±–ª–µ–º–∞
```json
"test": "echo \"No tests specified\" && exit 0"
```

#### –†–µ—à–µ–Ω–∏–µ
```bash
npm install -D vitest @testing-library/react @testing-library/jest-dom jsdom
npm install -D @testing-library/user-event
```

```typescript
// vitest.config.ts
import { defineConfig } from 'vitest/config';
import react from '@vitejs/plugin-react';
import path from 'path';

export default defineConfig({
  plugins: [react()],
  test: {
    environment: 'jsdom',
    globals: true,
    setupFiles: ['./tests/setup.ts'],
  },
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src'),
    },
  },
});
```

```typescript
// tests/setup.ts
import '@testing-library/jest-dom';
import { vi } from 'vitest';

// Mock Telegram WebApp
global.window.Telegram = {
  WebApp: {
    ready: vi.fn(),
    expand: vi.fn(),
    close: vi.fn(),
    initDataUnsafe: {
      user: {
        id: 123456789,
        first_name: 'Test',
        username: 'testuser',
      },
    },
    // ... –¥—Ä—É–≥–∏–µ –º–µ—Ç–æ–¥—ã
  },
};
```

–ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤:

```typescript
// tests/lib/auth.test.ts
import { describe, it, expect, vi } from 'vitest';
import { auth } from '@/lib/auth';
import { NextRequest } from 'next/server';

describe('auth', () => {
  it('should return null when no init data provided', async () => {
    const request = new NextRequest('http://localhost:3000/api/projects');
    const session = await auth(request);
    expect(session).toBeNull();
  });

  it('should validate and parse correct Telegram data', async () => {
    // ... —Ç–µ—Å—Ç —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
  });
});
```

```typescript
// tests/components/ProjectCard.test.tsx
import { describe, it, expect } from 'vitest';
import { render, screen } from '@testing-library/react';
import { ProjectCard } from '@/components/projects/ProjectCard';

describe('ProjectCard', () => {
  it('should render project title and description', () => {
    const project = {
      id: '1',
      title: 'Test Project',
      description: 'Test Description',
      status: 'ACTIVE' as const,
    };

    render(<ProjectCard project={project} />);

    expect(screen.getByText('Test Project')).toBeInTheDocument();
    expect(screen.getByText('Test Description')).toBeInTheDocument();
  });
});
```

–û–±–Ω–æ–≤–∏—Ç—å package.json:
```json
{
  "scripts": {
    "test": "vitest",
    "test:ui": "vitest --ui",
    "test:coverage": "vitest --coverage"
  }
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü° **–°–†–ï–î–ù–ò–ô**  
**–í—Ä–µ–º—è**: 8-12 —á–∞—Å–æ–≤ (–¥–ª—è –±–∞–∑–æ–≤–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è)

---

### 9. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

#### 9.1 Next.js –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```typescript
// next.config.ts
import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  // –í–∫–ª—é—á–∏—Ç—å standalone –¥–ª—è Docker
  output: 'standalone',

  // –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
  images: {
    formats: ['image/avif', 'image/webp'],
    deviceSizes: [640, 750, 828, 1080, 1200],
    imageSizes: [16, 32, 48, 64, 96, 128, 256],
  },

  // Compression
  compress: true,

  // Experimental features
  experimental: {
    optimizePackageImports: ['lucide-react', 'recharts'],
  },

  // Webpack optimizations
  webpack: (config, { isServer }) => {
    if (!isServer) {
      config.resolve.fallback = {
        ...config.resolve.fallback,
        fs: false,
        net: false,
        tls: false,
      };
    }
    return config;
  },

  // Headers –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
  async headers() {
    return [
      {
        source: '/(.*)',
        headers: [
          {
            key: 'X-Content-Type-Options',
            value: 'nosniff',
          },
          {
            key: 'X-Frame-Options',
            value: 'DENY',
          },
          {
            key: 'X-XSS-Protection',
            value: '1; mode=block',
          },
          {
            key: 'Referrer-Policy',
            value: 'strict-origin-when-cross-origin',
          },
        ],
      },
      {
        source: '/api/(.*)',
        headers: [
          {
            key: 'Cache-Control',
            value: 'no-store, must-revalidate',
          },
        ],
      },
      {
        source: '/icons/(.*)',
        headers: [
          {
            key: 'Cache-Control',
            value: 'public, max-age=31536000, immutable',
          },
        ],
      },
    ];
  },
};

export default nextConfig;
```

#### 9.2 Database –∏–Ω–¥–µ–∫—Å—ã

```prisma
// prisma/schema.prisma - –¥–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã

model Project {
  // ... existing fields
  
  @@index([userId, status])
  @@index([userId, createdAt])
  @@index([clientId])
}

model Task {
  // ... existing fields
  
  @@index([userId, status])
  @@index([projectId])
  @@index([userId, deadline])
  @@index([parentTaskId])
}

model Payment {
  // ... existing fields
  
  @@index([userId, status])
  @@index([projectId])
  @@index([userId, dueDate])
}

model Client {
  // ... existing fields
  
  @@index([userId])
  @@index([email])
}

model TimeSession {
  // ... existing fields
  
  @@index([userId, taskId])
  @@index([taskId, startTime])
}
```

#### 9.3 –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

```typescript
// src/lib/cache.ts
import { Redis } from '@upstash/redis';

const redis = process.env.REDIS_URL 
  ? new Redis({ url: process.env.REDIS_URL })
  : null;

export async function getCached<T>(
  key: string,
  fetcher: () => Promise<T>,
  ttl: number = 60 // seconds
): Promise<T> {
  if (!redis) {
    return fetcher();
  }

  // –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–ª—É—á–∏—Ç—å –∏–∑ –∫—ç—à–∞
  const cached = await redis.get<T>(key);
  if (cached) {
    return cached;
  }

  // –ï—Å–ª–∏ –Ω–µ—Ç –≤ –∫—ç—à–µ, –≤—ã–ø–æ–ª–Ω—è–µ–º fetcher
  const data = await fetcher();
  
  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∫—ç—à
  await redis.setex(key, ttl, JSON.stringify(data));

  return data;
}

export async function invalidateCache(pattern: string) {
  if (!redis) return;

  const keys = await redis.keys(pattern);
  if (keys.length > 0) {
    await redis.del(...keys);
  }
}
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:

```typescript
// src/app/api/projects/route.ts
import { getCached, invalidateCache } from '@/lib/cache';

export async function GET(request: NextRequest) {
  try {
    const session = await requireAuth(request);

    const projects = await getCached(
      `projects:${session.userId}`,
      async () => {
        return await prisma.project.findMany({
          where: { userId: session.userId },
          include: { client: true, tasks: true },
        });
      },
      300 // 5 –º–∏–Ω—É—Ç
    );

    return NextResponse.json({ success: true, projects });
  } catch (error) {
    return handleApiError(error);
  }
}

export async function POST(request: NextRequest) {
  try {
    const session = await requireAuth(request);
    // ... —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

    // –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–∞
    await invalidateCache(`projects:${session.userId}`);

    return NextResponse.json({ success: true, project });
  } catch (error) {
    return handleApiError(error);
  }
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü° **–°–†–ï–î–ù–ò–ô**  
**–í—Ä–µ–º—è**: 4-5 —á–∞—Å–æ–≤

---

### 10. CI/CD Pipeline

#### –ü—Ä–æ–±–ª–µ–º–∞
–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è.

#### –†–µ—à–µ–Ω–∏–µ
```yaml
# .github/workflows/ci.yml
name: CI/CD Pipeline

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main, develop]

env:
  NODE_VERSION: '18'

jobs:
  lint:
    name: Lint
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: 'npm'
      
      - name: Install dependencies
        run: npm ci
      
      - name: Run ESLint
        run: npm run lint

  typecheck:
    name: Type Check
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: 'npm'
      
      - name: Install dependencies
        run: npm ci
      
      - name: Generate Prisma Client
        run: npx prisma generate
      
      - name: Run TypeScript
        run: npm run type-check

  test:
    name: Test
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: 'npm'
      
      - name: Install dependencies
        run: npm ci
      
      - name: Generate Prisma Client
        run: npx prisma generate
      
      - name: Run tests
        run: npm test
      
      - name: Upload coverage
        uses: codecov/codecov-action@v3
        if: always()

  build:
    name: Build
    runs-on: ubuntu-latest
    needs: [lint, typecheck, test]
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: 'npm'
      
      - name: Install dependencies
        run: npm ci
      
      - name: Generate Prisma Client
        run: npx prisma generate
      
      - name: Build application
        run: npm run build
        env:
          DATABASE_URL: postgresql://dummy:dummy@localhost:5432/dummy
          TELEGRAM_BOT_TOKEN: dummy
          TELEGRAM_WEBHOOK_SECRET: dummy
          NEXTAUTH_SECRET: dummy_secret_32_characters_long
          NEXTAUTH_URL: http://localhost:3000

  deploy:
    name: Deploy to Production
    runs-on: ubuntu-latest
    needs: [build]
    if: github.ref == 'refs/heads/main'
    environment: production
    steps:
      - uses: actions/checkout@v4
      
      - name: Deploy to Vercel
        uses: amondnet/vercel-action@v25
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          vercel-org-id: ${{ secrets.VERCEL_ORG_ID }}
          vercel-project-id: ${{ secrets.VERCEL_PROJECT_ID }}
          vercel-args: '--prod'
```

```yaml
# .github/workflows/database.yml
name: Database Migration

on:
  workflow_dispatch:
    inputs:
      environment:
        description: 'Environment'
        required: true
        type: choice
        options:
          - staging
          - production

jobs:
  migrate:
    name: Run Migrations
    runs-on: ubuntu-latest
    environment: ${{ github.event.inputs.environment }}
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
      
      - name: Install dependencies
        run: npm ci
      
      - name: Run migrations
        run: npx prisma migrate deploy
        env:
          DATABASE_URL: ${{ secrets.DATABASE_URL }}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü° **–°–†–ï–î–ù–ò–ô**  
**–í—Ä–µ–º—è**: 3-4 —á–∞—Å–∞

---

## üü¢ –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø

### 11. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

```bash
npm install @sentry/nextjs
```

```typescript
// sentry.client.config.ts
import * as Sentry from '@sentry/nextjs';

Sentry.init({
  dsn: process.env.NEXT_PUBLIC_SENTRY_DSN,
  environment: process.env.NODE_ENV,
  tracesSampleRate: 1.0,
  replaysOnErrorSampleRate: 1.0,
  replaysSessionSampleRate: 0.1,
  integrations: [
    new Sentry.BrowserTracing(),
    new Sentry.Replay(),
  ],
});
```

```typescript
// sentry.server.config.ts
import * as Sentry from '@sentry/nextjs';

Sentry.init({
  dsn: process.env.NEXT_PUBLIC_SENTRY_DSN,
  environment: process.env.NODE_ENV,
  tracesSampleRate: 1.0,
});
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü¢ **–ù–ò–ó–ö–ò–ô**  
**–í—Ä–µ–º—è**: 2 —á–∞—Å–∞

---

### 12. –£–ª—É—á—à–µ–Ω–∏–µ UI/UX

#### 12.1 –°–∫–µ–ª–µ—Ç–æ–Ω—ã –∑–∞–≥—Ä—É–∑–∫–∏

```typescript
// src/components/ui/skeleton.tsx
export function ProjectSkeleton() {
  return (
    <Card>
      <CardHeader>
        <Skeleton className="h-4 w-3/4" />
        <Skeleton className="h-3 w-1/2 mt-2" />
      </CardHeader>
      <CardContent>
        <Skeleton className="h-3 w-full" />
        <Skeleton className="h-3 w-5/6 mt-2" />
      </CardContent>
    </Card>
  );
}
```

#### 12.2 –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

```typescript
// src/hooks/useOptimisticUpdate.ts
import { useOptimistic } from 'react';

export function useOptimisticTasks(initialTasks: Task[]) {
  const [optimisticTasks, setOptimisticTasks] = useOptimistic(
    initialTasks,
    (state, newTask: Task) => {
      return [...state, newTask];
    }
  );

  const addTask = async (task: Omit<Task, 'id'>) => {
    const tempTask = { ...task, id: 'temp-' + Date.now() };
    setOptimisticTasks(tempTask as Task);

    try {
      const response = await fetch('/api/tasks', {
        method: 'POST',
        body: JSON.stringify(task),
      });
      const data = await response.json();
      return data.task;
    } catch (error) {
      // Rollback –ø—Ä–∏ –æ—à–∏–±–∫–µ
      throw error;
    }
  };

  return { optimisticTasks, addTask };
}
```

#### 12.3 Infinite scroll –¥–ª—è —Å–ø–∏—Å–∫–æ–≤

```bash
npm install react-intersection-observer
```

```typescript
// src/hooks/useInfiniteScroll.ts
import { useInView } from 'react-intersection-observer';
import { useEffect, useState } from 'react';

export function useInfiniteScroll<T>(
  fetchFn: (page: number) => Promise<T[]>,
  initialPage = 1
) {
  const [items, setItems] = useState<T[]>([]);
  const [page, setPage] = useState(initialPage);
  const [loading, setLoading] = useState(false);
  const [hasMore, setHasMore] = useState(true);

  const { ref, inView } = useInView();

  const loadMore = async () => {
    if (loading || !hasMore) return;

    setLoading(true);
    try {
      const newItems = await fetchFn(page);
      if (newItems.length === 0) {
        setHasMore(false);
      } else {
        setItems((prev) => [...prev, ...newItems]);
        setPage((prev) => prev + 1);
      }
    } catch (error) {
      console.error('Error loading more items:', error);
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    if (inView) {
      loadMore();
    }
  }, [inView]);

  return { items, loading, hasMore, ref };
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü¢ **–ù–ò–ó–ö–ò–ô**  
**–í—Ä–µ–º—è**: 6-8 —á–∞—Å–æ–≤

---

### 13. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API (Swagger/OpenAPI)

```bash
npm install next-swagger-doc swagger-ui-react
```

```typescript
// src/lib/swagger.ts
import { createSwaggerSpec } from 'next-swagger-doc';

export const getApiDocs = () => {
  const spec = createSwaggerSpec({
    apiFolder: 'src/app/api',
    definition: {
      openapi: '3.0.0',
      info: {
        title: 'Raising CRM API',
        version: '1.0.0',
        description: 'API documentation for Raising CRM',
      },
      servers: [
        {
          url: 'http://localhost:3000',
          description: 'Development server',
        },
      ],
      components: {
        securitySchemes: {
          telegram: {
            type: 'apiKey',
            in: 'header',
            name: 'x-telegram-init-data',
          },
        },
      },
      security: [{ telegram: [] }],
    },
  });

  return spec;
};
```

```typescript
// src/app/api-docs/page.tsx
'use client';

import SwaggerUI from 'swagger-ui-react';
import 'swagger-ui-react/swagger-ui.css';
import { getApiDocs } from '@/lib/swagger';

export default function ApiDocsPage() {
  const spec = getApiDocs();
  return <SwaggerUI spec={spec} />;
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü¢ **–ù–ò–ó–ö–ò–ô**  
**–í—Ä–µ–º—è**: 4-5 —á–∞—Å–æ–≤

---

### 14. Webhooks –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

```typescript
// src/lib/webhooks.ts
interface WebhookPayload {
  event: string;
  data: unknown;
  timestamp: string;
}

export async function sendWebhook(
  url: string,
  payload: WebhookPayload
): Promise<void> {
  try {
    const response = await fetch(url, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'User-Agent': 'Raising-CRM-Webhook/1.0',
      },
      body: JSON.stringify(payload),
    });

    if (!response.ok) {
      throw new Error(`Webhook failed: ${response.statusText}`);
    }
  } catch (error) {
    logger.error({ error, url }, 'Failed to send webhook');
    throw error;
  }
}

// –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —á–µ—Ä–µ–∑ Telegram
export async function sendTelegramNotification(
  chatId: string,
  message: string
): Promise<void> {
  const botToken = env.TELEGRAM_BOT_TOKEN;
  const url = `https://api.telegram.org/bot${botToken}/sendMessage`;

  await fetch(url, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      chat_id: chatId,
      text: message,
      parse_mode: 'HTML',
    }),
  });
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü¢ **–ù–ò–ó–ö–ò–ô**  
**–í—Ä–µ–º—è**: 3-4 —á–∞—Å–∞

---

### 15. –£–ª—É—á—à–µ–Ω–∏–µ Prisma —Å—Ö–µ–º—ã

```prisma
// prisma/schema.prisma

// –î–æ–±–∞–≤–∏—Ç—å soft delete
model Project {
  // ... existing fields
  deletedAt DateTime?
  
  @@map("projects")
}

// –î–æ–±–∞–≤–∏—Ç—å –∞—É–¥–∏—Ç
model AuditLog {
  id        String   @id @default(cuid())
  userId    String
  user      User     @relation(fields: [userId], references: [id])
  action    String   // CREATE, UPDATE, DELETE
  entity    String   // Project, Task, etc.
  entityId  String
  changes   Json?    // –î–æ –∏ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
  ipAddress String?
  userAgent String?
  createdAt DateTime @default(now())

  @@index([userId, createdAt])
  @@index([entity, entityId])
  @@map("audit_logs")
}

// –î–æ–±–∞–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É —Ç–µ–≥–æ–≤
model Tag {
  id        String   @id @default(cuid())
  name      String
  color     String   @default("#3b82f6")
  userId    String
  user      User     @relation(fields: [userId], references: [id])
  projects  ProjectTag[]
  tasks     TaskTag[]
  createdAt DateTime @default(now())

  @@unique([userId, name])
  @@map("tags")
}

model ProjectTag {
  projectId String
  project   Project @relation(fields: [projectId], references: [id], onDelete: Cascade)
  tagId     String
  tag       Tag     @relation(fields: [tagId], references: [id], onDelete: Cascade)

  @@id([projectId, tagId])
  @@map("project_tags")
}

model TaskTag {
  taskId String
  task   Task   @relation(fields: [taskId], references: [id], onDelete: Cascade)
  tagId  String
  tag    Tag    @relation(fields: [tagId], references: [id], onDelete: Cascade)

  @@id([taskId, tagId])
  @@map("task_tags")
}

// –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –ë–î
model Notification {
  id        String   @id @default(cuid())
  userId    String
  user      User     @relation(fields: [userId], references: [id])
  title     String
  message   String
  type      String   // INFO, WARNING, ERROR, SUCCESS
  read      Boolean  @default(false)
  link      String?
  createdAt DateTime @default(now())
  readAt    DateTime?

  @@index([userId, read])
  @@index([userId, createdAt])
  @@map("notifications")
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü¢ **–ù–ò–ó–ö–ò–ô**  
**–í—Ä–µ–º—è**: 4-5 —á–∞—Å–æ–≤

---

## üìä –ü–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

### –≠—Ç–∞–ø 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (1-2 –¥–Ω—è)
1. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é (#1)
2. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å TypeScript –æ—à–∏–±–∫–∏ (#2)
3. ‚úÖ –ó–∞–º–µ–Ω–∏—Ç—å `any` —Ç–∏–ø—ã (#3)

### –≠—Ç–∞–ø 2: –í–∞–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (3-5 –¥–Ω–µ–π)
4. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é Zod (#4)
5. ‚úÖ –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ (#5)
6. ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (#6)
7. ‚úÖ Rate limiting (#7)

### –≠—Ç–∞–ø 3: –ö–∞—á–µ—Å—Ç–≤–æ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å (1-2 –Ω–µ–¥–µ–ª–∏)
8. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (#8)
9. ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (#9)
10. ‚úÖ CI/CD Pipeline (#10)

### –≠—Ç–∞–ø 4: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
11. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (#11)
12. UI/UX —É–ª—É—á—à–µ–Ω–∏—è (#12)
13. API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (#13)
14. Webhooks (#14)
15. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ Prisma —Å—Ö–µ–º—ã (#15)

---

## üîß –ë—ã—Å—Ç—Ä—ã–π —á–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–æ–º

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ —Ä–µ–∞–ª—å–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è Telegram
- [ ] –í—Å–µ API endpoints –∑–∞—â–∏—â–µ–Ω—ã auth middleware
- [ ] –î–æ–±–∞–≤–ª–µ–Ω rate limiting
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- [ ] HTTPS –≤ production
- [ ] –°–µ–∫—Ä–µ—Ç—ã –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (–Ω–µ –≤ –∫–æ–¥–µ)
- [ ] CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- [ ] –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–Ω–¥–µ–∫—Å—ã –≤ –ë–î
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î (N+1 –ø—Ä–æ–±–ª–µ–º–∞)
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ —Å–∂–∞—Ç–∏–µ –æ—Ç–≤–µ—Ç–æ–≤
- [ ] Image optimization –≤–∫–ª—é—á–µ–Ω–∞
- [ ] Bundle size –ø—Ä–æ–≤–µ—Ä–µ–Ω –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –ü–æ–¥–∫–ª—é—á–µ–Ω –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—à–∏–±–æ–∫ (Sentry)
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã health checks
- [ ] Database monitoring
- [ ] –ê–ª–µ—Ä—Ç—ã –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–±—ã—Ç–∏—è

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] Unit —Ç–µ—Å—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π –ª–æ–≥–∏–∫–∏
- [ ] Integration —Ç–µ—Å—Ç—ã –¥–ª—è API
- [ ] E2E —Ç–µ—Å—Ç—ã –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ–ª–æ—É
- [ ] –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ > 70%

### DevOps
- [ ] CI/CD pipeline —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
- [ ] Staging –æ–∫—Ä—É–∂–µ–Ω–∏–µ
- [ ] Backup strategy
- [ ] Rollback plan

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [ ] README –æ–±–Ω–æ–≤–ª–µ–Ω
- [ ] API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [ ] Deployment –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
- [ ] Environment variables –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã

---

## üí° –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
1. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —Å–ª–æ–∏**: –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ Repository pattern –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î
2. **Service layer**: –í—ã–Ω–µ—Å—Ç–∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –∏–∑ API routes –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
3. **DTO pattern**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Data Transfer Objects –¥–ª—è API
4. **Event-driven**: –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å —Å–æ–±—ã—Ç–∏—è –¥–ª—è —Å–ª–∞–±–æ–π —Å–≤—è–∑–Ω–æ—Å—Ç–∏ –º–æ–¥—É–ª–µ–π

### –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
1. **Database sharding**: –ü—Ä–∏ —Ä–æ—Å—Ç–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏—è
2. **Caching strategy**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Å–µ—Å—Å–∏–π
3. **CDN**: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CDN –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
4. **Background jobs**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—á–µ—Ä–µ–¥–∏ –¥–ª—è —Ç—è–∂–µ–ª—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (Bull/BullMQ)

### UX/UI
1. **Accessibility**: –î–æ–±–∞–≤–∏—Ç—å ARIA –∞—Ç—Ä–∏–±—É—Ç—ã, –ø–æ–¥–¥–µ—Ä–∂–∫—É –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
2. **Internationalization**: –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∫ i18n –µ—Å–ª–∏ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è multi-language
3. **Dark mode**: –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–º–Ω—É—é —Ç–µ–º—É
4. **Mobile gestures**: –î–æ–±–∞–≤–∏—Ç—å swipe-to-delete –∏ pull-to-refresh

### –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
1. **User analytics**: –î–æ–±–∞–≤–∏—Ç—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
2. **Performance monitoring**: Real User Monitoring (RUM)
3. **Feature flags**: –°–∏—Å—Ç–µ–º–∞ –¥–ª—è –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–≥–æ —Ä–∞—Å–∫–∞—Ç—ã–≤–∞–Ω–∏—è —Ñ–∏—á
4. **A/B testing**: –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤

---

## üìà –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ
- ‚úÖ TypeScript: 0 –æ—à–∏–±–æ–∫
- ‚úÖ ESLint: 0 –æ—à–∏–±–æ–∫, < 10 –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
- ‚úÖ Test coverage: > 70%
- ‚úÖ Lighthouse Score: > 90
- ‚úÖ Bundle size: < 500KB (gzipped)
- ‚úÖ API response time: < 500ms (p95)

### –ë–∏–∑–Ω–µ—Å
- ‚úÖ Uptime: > 99.9%
- ‚úÖ Error rate: < 0.1%
- ‚úÖ Page load time: < 2s
- ‚úÖ User satisfaction: NPS > 50

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ –≤–æ–ø—Ä–æ—Å—ã

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã –ø–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—é —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π:
1. –°–æ–∑–¥–∞–π—Ç–µ issue –≤ GitHub
2. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Next.js, Prisma, shadcn/ui
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –Ø–Ω–≤–∞—Ä—å 2025  
**–ê–≤—Ç–æ—Ä –∞–Ω–∞–ª–∏–∑–∞**: AI Development Assistant  
**–°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞**: 85% ‚Üí 100% (–ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π)
